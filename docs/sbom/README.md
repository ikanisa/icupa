# Software Bill of Materials (SBOM)

**Format:** CycloneDX 1.4 (JSON)  
**Last Generated:** 2025-10-29  

## Overview

This directory contains Software Bill of Materials (SBOM) for the ICUPA platform. SBOMs provide a complete inventory of all software components, libraries, and dependencies used in the project.

## Files

- `icupa-root-basic.json` - Root workspace SBOM (basic structure)
- `agents-service.json` - Agents service SBOM (basic structure)
- `generate-sboms.sh` - Script to generate SBOMs manually

**Note:** Full SBOMs with complete dependency trees will be generated by the CI/CD pipeline (`.github/workflows/sbom.yml`) on releases and pushes to main.

## Generation

SBOMs are automatically generated by GitHub Actions using CycloneDX npm:

```bash
# Automatic (CI/CD)
# Triggered on: releases, pushes to main, manual dispatch

# Manual generation
./generate-sboms.sh

# Or using CycloneDX directly
npm install -g @cyclonedx/cyclonedx-npm
cyclonedx-npm --output-format JSON --output-file icupa-root.json
```

## Validation

To validate SBOM files:

```bash
npm install -g @cyclonedx/cyclonedx-cli
cyclonedx-cli validate --input-file icupa-root-basic.json
```

## Use Cases

### 1. Vulnerability Scanning
Import SBOMs into vulnerability scanning tools:
- Snyk
- Grype
- OWASP Dependency-Track
- GitHub Dependabot (automatic)

### 2. License Compliance
Track license obligations:
- Identify copyleft licenses
- Document attribution requirements
- Ensure license compatibility

### 3. Supply Chain Security
- Track upstream dependencies
- Monitor for compromised packages
- Verify package integrity
- SLSA provenance (future)

### 4. Regulatory Compliance
- Executive Order 14028 (US)
- EU Cyber Resilience Act
- Industry-specific requirements

## SBOM Contents

Each SBOM includes:

- **Metadata:**
  - Timestamp
  - Component name and version
  - BOM format and spec version

- **Components:** (Full SBOMs only)
  - Package name
  - Version
  - License (SPDX identifier)
  - Package URL (purl)
  - Checksums
  - Dependencies

- **Dependencies:** (Full SBOMs only)
  - Dependency graph
  - Direct vs transitive
  - Optional dependencies

## Integration

### CI/CD Pipeline
`.github/workflows/sbom.yml` automatically:
1. Generates SBOMs on release/push
2. Validates format
3. Uploads as artifacts (90-day retention)
4. Commits to repository (on push to main)

### Consuming Tools

#### Dependency-Track
```bash
# Upload to Dependency-Track
curl -X "POST" "https://dependency-track.example.com/api/v1/bom" \
  -H "X-Api-Key: $DT_API_KEY" \
  -H "Content-Type: multipart/form-data" \
  -F "project=$PROJECT_UUID" \
  -F "bom=@icupa-root.json"
```

#### Grype
```bash
# Scan SBOM for vulnerabilities
grype sbom:./icupa-root.json
```

#### Syft
```bash
# Generate SBOM from container
syft packages oci-dir:./agents-service -o cyclonedx-json > agents-container.json
```

## Maintenance

### Update Frequency
- **Automatic:** Every release and push to main
- **Manual:** As needed for audits or compliance
- **Validation:** Monthly review recommended

### Retention
- **Git Repository:** Permanent (tracks changes over time)
- **GitHub Artifacts:** 90 days
- **Dependency-Track:** Per tool configuration

### Signing (Future)
Consider signing SBOMs for integrity:
```bash
cosign sign-blob --key cosign.key icupa-root.json > icupa-root.json.sig
```

## Related Documentation

- [SECURITY.md](../../SECURITY.md) - Security policy
- [Risk Register](../risk-register.csv) - Risk tracking
- [Release Runbook](../release-runbook.md) - Deployment procedures

## Compliance Notes

### NTIA Minimum Elements (US)
✅ Supplier Name  
✅ Component Name  
✅ Version  
✅ Other Unique Identifiers  
✅ Dependency Relationships  
✅ Author of SBOM Data  
✅ Timestamp  

### SBOM Depth
- **Current:** Shallow (basic structure)
- **Target:** Deep (full dependency tree with licenses and checksums)
- **Timeline:** Full implementation by next major release

## Support

For questions or issues with SBOMs:
- **Technical:** DevOps team via Slack
- **Compliance:** Security/Compliance team
- **Tools:** See [SUPPORT.md](../../SUPPORT.md)

---

**Last Updated:** 2025-10-29  
**Maintained By:** DevOps Team
