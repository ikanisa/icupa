id,title,severity,area,description,evidence,fix,owner,due_date
S0-001,High-Severity Dependency Vulnerabilities,S0,Security,"Next.js 14.2.5 has HIGH severity CVE-2024-46982 (cache poisoning), esbuild and other dependencies have known vulnerabilities","pnpm audit output shows 6+ high-severity advisories including Next.js cache poisoning (CVSS 7.5), esbuild vulnerabilities, @supabase/auth-js issues","Update Next.js to >=14.2.10, update all dependencies with CVEs to latest patched versions, run pnpm audit after updates",DevOps/Security,Before Staging
S1-002,Missing Dependabot/Renovate Configuration,S1,Security/Operations,"No automated dependency update configuration; security vulnerabilities will accumulate over time without manual intervention","No .github/dependabot.yml or renovate.json file present in repository","Add Dependabot config with weekly schedule, enable security updates, configure auto-merge for patch versions with passing CI",DevOps,Before Production
S1-003,Docker Container Runs as Root,S1,Security/Infrastructure,"agents-service Dockerfile runs build stages as root user, increasing risk of container escape and privilege escalation","agents-service/Dockerfile shows USER node only in final runtime stage (line 49), deps and build stages run as root","Add USER node directive after RUN npm ci in deps stage, use --chown=node:node in COPY commands, validate with docker run --user check",DevOps,Before Production
S1-004,Missing .dockerignore,S1,Security/Build,"No .dockerignore file; secrets, .env files, tests, and unnecessary files may leak into Docker image","No .dockerignore file in agents-service/ directory","Create .dockerignore excluding .env*, secrets*, node_modules, tests, *.test.*, .git, README.md, docs, coverage",DevOps,Before Production
S1-005,Missing CodeQL/SAST Workflow,S1,Security,"No static application security testing in CI/CD pipeline; security vulnerabilities go undetected until manual review","No .github/workflows/codeql.yml or equivalent SAST workflow","Add CodeQL workflow for JavaScript/TypeScript analysis, configure to run on push to main and PRs, set security-events write permission",DevOps/Security,Before Production
S1-006,Missing SECURITY.md,S1,Security/Documentation,"No security policy file for responsible vulnerability disclosure; researchers don't know how to report security issues","No SECURITY.md file in repository root","Create SECURITY.md with vulnerability reporting process, supported versions, response SLA, and contact information",Security/Compliance,Before Public Deployment
S1-007,Missing SUPPORT.md and CODEOWNERS,S1,Operations/Documentation,"No support documentation or code ownership defined; unclear escalation paths and accountability","No SUPPORT.md in root, no .github/CODEOWNERS file","Create SUPPORT.md with support channels and SLAs, create CODEOWNERS with team/individual ownership per directory",Operations,Before Production
S1-008,No SBOM Generation in CI,S1,Security/Compliance,"No Software Bill of Materials generation in CI/CD; supply chain visibility and compliance requirements unmet","No SBOM generation workflow in .github/workflows/","Add workflow to generate CycloneDX or SPDX SBOM on releases, upload as artifact, commit to docs/sbom/ directory",DevOps/Security,Before Production
S1-009,No Coverage Gate in CI,S1,Quality,"Tests run in CI but no coverage enforcement (target ≥80%); quality can drift without visibility","ci.yml runs tests but doesn't collect or enforce coverage thresholds","Add vitest coverage collection with --coverage flag, add coverage gate with minimum 80% or current+10% threshold, fail CI if below",Engineering,Before Production
S1-010,Missing Release Runbook,S1,Operations,"No formal release procedures, rollback plan, or smoke tests documented; risk of failed deployments and extended outages","No docs/release-runbook.md file","Create comprehensive release runbook with: build → test → stage → prod steps, roll-forward/rollback procedures, smoke tests, on-call handoff",Operations/SRE,Before Production
S1-011,No Alert Definitions,S1,Operations/Observability,"No documented alert configurations for PagerDuty/Opsgenie; incidents may go undetected or have delayed response","No alerts/ directory or alert definitions in runbooks","Document alert definitions for: payment failures >1%, receipt generation >5s p95, agent hallucinations >0.5%, database CPU >80%, configure in monitoring tool",SRE,Before Production
S2-012,No CSP Headers,S2,Security/Web,"No Content-Security-Policy headers defined for web application; XSS risk not mitigated at transport layer","No CSP meta tag in index.html, no CSP configuration in Vite config or deployment","Add CSP headers: default-src 'self', script-src 'self', style-src 'self' 'unsafe-inline', connect-src 'self' *.supabase.co *.stripe.com",Frontend/DevOps,Within 30 Days
S2-013,No HSTS Configuration,S2,Security/Web,"No HTTP Strict-Transport-Security headers; man-in-the-middle downgrade attacks possible","No HSTS configuration in deployment or reverse proxy settings","Add HSTS header: max-age=31536000; includeSubDomains; preload, submit to HSTS preload list",DevOps,Within 30 Days
S2-014,Mobile Network Security Config Not Verified,S2,Security/Mobile,"Mobile app network security configuration not explicitly verified; cleartext traffic may be allowed","No networkSecurityConfig.xml in Android res/xml, iOS ATS settings not documented","For Android: Add networkSecurityConfig with cleartextTrafficPermitted=false. For iOS: Verify NSAllowsArbitraryLoads=false in Info.plist",Mobile/Security,Within 30 Days
S2-015,No Documented Secret Rotation Procedures,S2,Security/Operations,"No procedures for rotating API keys, database credentials, or JWT secrets; compromised secrets cannot be quickly rotated","No docs/security/secret-rotation.md or equivalent procedures","Document secret rotation procedures for: Supabase keys, Stripe keys, OpenAI keys, database passwords, JWT signing keys, test rotation annually",Security/Operations,Within 30 Days
S2-016,Rate Limiting Not Explicit,S2,Security/Reliability,"No explicit rate limiting configuration on Edge Functions beyond Supabase defaults; abuse/DoS risk","Edge Functions rely on Supabase platform rate limits, no custom middleware","Document Supabase rate limits, add custom rate limiting middleware to critical endpoints (auth, payments), implement per-tenant quotas",Backend/Security,Within 30 Days
S2-017,Log Sanitization Not Verified,S2,Security/Privacy,"No verification that logs don't leak PII or secrets; potential GDPR violations and secret exposure","Logging exists but no explicit sanitization middleware or tests","Audit all log statements, add sanitization middleware to redact PII (email, phone, payment details) and secrets, add tests to verify",Backend/Compliance,Within 30 Days
S2-018,Data Retention/Deletion Policies Not Documented,S2,Privacy/Compliance,"No documented data retention periods or deletion procedures for GDPR/DPL compliance","No docs/compliance/data-retention.md or deletion procedures","Document retention policies: orders (7 years for tax), PII (user request + 30 days), logs (90 days), implement automated deletion jobs",Compliance/Engineering,Within 30 Days
S2-019,Backup and Restore Procedures Not Documented,S2,Operations/Reliability,"Database backup and restore procedures not formally documented; RTO/RPO undefined","Supabase provides automated backups but restore procedures not documented in runbooks","Document: backup schedule (Supabase defaults), restore procedure with test, RTO target (4 hours), RPO target (1 hour), test restore quarterly",Operations/SRE,Within 30 Days
S2-020,No Formal SLOs Defined,S2,Reliability/Operations,"No service level objectives defined; cannot measure or improve reliability systematically","README mentions performance budgets but no formal SLO definitions","Define SLOs: availability 99.5%, LCP ≤2.5s p95, payment success ≥99.5%, receipt generation ≤5s p95, error budget policy",SRE/Product,Within 30 Days
S2-021,No Load Test Baseline,S2,Performance/Reliability,"k6 load tests exist but no baseline metrics or target throughput defined; cannot validate capacity","tests/k6/ directory has scripts but no results or baselines documented","Run load tests, establish baselines: 100 RPS for create_table_session, 50 RPS for payments, document in docs/performance-baseline.md",Engineering/SRE,Within 30 Days
S2-022,No N+1 Query Detection,S2,Performance/Reliability,"Database query efficiency not validated; potential N+1 query problems may cause performance issues at scale","No query monitoring or N+1 detection tools configured","Add query logging in development, use Supabase dashboard to identify slow queries, document common patterns in docs/database-patterns.md",Backend/SRE,Within 60 Days
S2-023,Database Index Coverage Not Validated,S2,Performance/Reliability,"No systematic query analysis to validate all hot paths have appropriate indexes","Indexes exist (e.g., items.embedding ivfflat) but no comprehensive index strategy documented","Analyze query patterns from production logs, add missing indexes, document index strategy in database migration comments",Backend/DBA,Within 60 Days
S2-024,No Centralized Logging,S2,Observability/Operations,"Logs are local to each service; no centralized aggregation for search and alerting","OpenTelemetry configured but no log shipping to CloudWatch/Datadog configured","Configure log shipping: agents-service → CloudWatch/Datadog, Supabase logs → aggregator, add log-based alerts",DevOps/SRE,Within 30 Days
S2-025,No Dashboards,S2,Observability/Operations,"Grafana/DataDog dashboards not created; limited operational visibility into system health","Metrics available (queue depths, cron jobs) but no visualization","Create dashboards: service health (golden signals), payment funnel, fiscal receipts, agent performance, database metrics",SRE,Within 30 Days
S2-026,Trace/Correlation IDs Not Validated,S2,Observability/Operations,"Correlation IDs mentioned but not verified across all services; distributed tracing incomplete","OpenTelemetry in agents-service but correlation across Edge Functions not validated","Add trace ID generation in client, propagate through all services, validate end-to-end tracing with sample request",Backend/SRE,Within 60 Days
S2-027,Manual Deployments,S2,Release/Operations,"Deployments are manual via Supabase CLI; no GitOps or automated deployment pipeline","supabase-deploy.yml requires manual workflow_dispatch trigger","Implement automated deployments: main branch → staging (auto), staging → production (manual approval), add deployment notifications",DevOps,Within 60 Days
S2-028,No Canary/Blue-Green Strategy,S2,Release/Reliability,"All-or-nothing deployments; no gradual rollout or traffic shifting capability","Current deployment strategy replaces all Edge Functions at once","Implement canary deployment: route 5% → 50% → 100% traffic over time, add automatic rollback on error rate increase",DevOps/SRE,Within 90 Days
S2-029,Rollback Strategy Not Documented or Tested,S2,Release/Operations,"Database rollback via .down.sql migrations not tested; no Edge Function version rollback procedure","Migration rollbacks exist but never executed, no version tags on functions","Document rollback procedure, test database rollback in staging, implement Edge Function versioning (e.g., v1, v2 suffixes), test end-to-end rollback",Operations/SRE,Before Production
S2-030,Post-Deploy Validation Not Automated,S2,Release/Quality,"Post-deploy health checks manual; no automated smoke tests in production after deployment","post-deploy-health.yml exists but not triggered automatically on production deploys","Add automated smoke tests to production deploy workflow: health checks, payment test transaction, receipt generation test",DevOps/QA,Within 60 Days
S2-031,Docker Base Image Not Pinned,S2,Security/Build,"Docker base image uses 'node:20-slim' tag instead of SHA256 digest; supply chain attack risk","agents-service/Dockerfile line 3, 15: FROM node:20-slim","Pin base images to digests: FROM node:20-slim@sha256:..., update monthly, document in Dockerfile comments",DevOps,Within 60 Days
S2-032,No Container Scanning in CI,S2,Security/Build,"Docker images not scanned for vulnerabilities before deployment; vulnerable images may reach production","No Trivy, Snyk, or similar scanning in CI workflows","Add container scanning workflow: scan on PR, fail on HIGH/CRITICAL CVEs, publish scan results as artifact",DevOps/Security,Within 30 Days
S2-033,Infrastructure Not Codified,S2,Operations/Reliability,"Supabase configuration manual; no Infrastructure as Code (Terraform/Pulumi) for reproducibility","No terraform/ or pulumi/ directory, manual project setup via dashboard","Create IaC: Supabase project config, database settings, secret references (not values), Edge Function routing, storage buckets",DevOps,Within 90 Days
S2-034,Data Subject Rights Tooling Not Documented,S2,Privacy/Compliance,"GDPR data subject rights (export/delete) not implemented or documented; compliance risk","No documented API or admin tool for data export/deletion requests","Implement data export API (JSON format), implement deletion with cascading rules, document in SECURITY.md, add compliance audit log",Compliance/Backend,Within 30 Days
S2-035,No DPA Templates,S2,Privacy/Compliance,"No data processing agreement templates for tenants/merchants; B2B compliance gap","No docs/compliance/dpa-template.md or equivalent","Create DPA template covering: data types, processing purposes, security measures, sub-processors, data residency, breach notification",Legal/Compliance,Within 60 Days
S2-036,Data Residency Not Enforced,S2,Compliance/Operations,"Rwanda data localization not explicitly enforced in Supabase configuration; potential regulatory violation","Supabase project region not explicitly locked to Rwanda-compliant region","Verify Supabase project region, document region selection rationale, implement geo-fencing if required by Rwanda DPL",Compliance/DevOps,Within 30 Days
S2-037,Fiscal Production Credentials Not Configured,S2,Compliance/Operations,"Rwanda EBM and Malta fiscal production credentials not yet configured; blocking go-live","Receipt stubs present but production credentials missing from Supabase secrets","Obtain production credentials from Rwanda RRA and Malta authorities, configure in Supabase secrets, test with sandbox first",Compliance/Operations,Before Production
S2-038,Receipt Validation Not Tested,S2,Compliance/Quality,"Fiscal receipt generation not tested against live Rwanda/Malta systems; may fail in production","Stubs exist but no integration test with real fiscal authorities","Test against sandbox/test systems: Rwanda EBM 2.1 test endpoint, Malta fiscal test endpoint, validate receipt format and QR codes",Compliance/QA,Before Production
S3-039,Keyboard Navigation Not Explicitly Tested,S3,Accessibility/Quality,"Keyboard navigation not covered in E2E tests; may have focus traps or tab order issues","Axe-core tests present but no keyboard-specific test scenarios","Add Playwright tests: tab navigation through menu, focus management in modals, escape key handling, focus visible styles",Frontend/QA,Post-Launch
S3-040,Screen Reader Testing Not Documented,S3,Accessibility/Quality,"TalkBack/VoiceOver testing procedures not documented; blind/low-vision users may have poor experience","No screen reader test checklists or procedures in docs/","Document screen reader testing procedure, add aria-labels where missing, test critical flows (order, pay) with NVDA/VoiceOver",Frontend/Accessibility,Post-Launch
S3-041,No Chaos Engineering Tests,S3,Reliability,"Resilience not tested under failure conditions; actual behavior under database/API outages unknown","No chaos tests (database kill, network partition, API timeout simulation)","Implement chaos tests: database unavailable, Stripe API down, OpenAI timeout, validate graceful degradation and error messages",SRE/Engineering,Post-Launch
S3-042,No Package Provenance,S3,Security/Build,"npm package provenance not enabled; supply chain attestation missing","No --provenance flag in npm publish, no SLSA attestation","Enable npm provenance: configure OIDC for npm publish, add provenance signatures, document in CI/CD",DevOps/Security,Post-Launch
S3-043,Pre-existing Lint Warnings,S3,Quality,"22 ESLint warnings in ecotrips app (react-refresh warnings, exhaustive-deps)","pnpm lint shows 22 warnings in apps/ecotrips/**","Document exceptions in .eslintrc, fix low-hanging fruit, create issues for remaining warnings, set target to reduce by 50%",Engineering,Post-Launch
