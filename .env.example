# === NETLIFY DEPLOYMENT CONFIGURATION ===
# Add these to your Netlify site's environment variables via the dashboard
# For local development, add them to .env.local

# === NETLIFY DEPLOYMENT CONFIGURATION ===
# Add these to your Netlify site's environment variables via the dashboard
# For local development, add them to .env.local

# --- Supabase Configuration (Required for all apps) ---
VITE_SUPABASE_URL=https://your-supabase-project.supabase.co
VITE_SUPABASE_ANON_KEY=supabase-anon-key

# (Server-side only variables are listed below in the Backend + automation secrets section)
# --- Supabase Configuration (Required for all apps) ---
VITE_SUPABASE_URL=https://your-supabase-project.supabase.co
VITE_SUPABASE_ANON_KEY=supabase-anon-key
SUPABASE_URL=https://your-supabase-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
SUPABASE_ACCESS_TOKEN=your-access-token

# --- Public Environment Variables (Safe for client) ---
VITE_APP_NAME=ICUPA
VITE_ADMIN_SERVICE_TOKEN=
VITE_AGENTS_STREAMING=true
VITE_AGENTS_LONG_POLLING=false
VITE_VAPID_PUBLIC_KEY=
VITE_AGENTS_URL=https://agents.icupa.dev
VITE_API_AGENTS_URL=
PUBLIC_AGENTS_URL=

# --- Backend + automation secrets (keep private) ---
OPENAI_API_KEY=
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_DEFAULT_MODEL=gpt-4.1
OPENAI_LOW_COST_MODEL=gpt-4o-mini
OPENAI_FAILOVER_MODEL=gpt-4o-mini
OPENAI_USE_RESPONSES_API=true
AGENTS_MENU_VECTOR_STORE_ID=
AGENTS_ALLERGENS_VECTOR_STORE_ID=
AGENTS_POLICIES_VECTOR_STORE_ID=
AGENT_SESSION_BUDGET_USD=0.75
AGENT_DAILY_BUDGET_USD=50
SUPABASE_URL=https://your-supabase-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=
SUPABASE_ACCESS_TOKEN=
SUPABASE_PROXY_ALLOWED_ROLES=ops,admin
SUPABASE_PROXY_TABLE_ALLOWLIST={"sessions":["select","update"],"orders":["select","insert","update"]}
SUPABASE_PROXY_COLUMN_ALLOWLIST={"sessions":["id","status","ended_at"],"orders":["id","status","tenant_id","location_id"]}
SUPABASE_PROXY_RATE_LIMIT=60

# --- Supabase Proxy Security Configuration (Netlify Functions) ---
# Table allowlist: JSON object mapping table names to allowed operations
# Example: {"users":["select","update"],"orders":["select","insert"]}
SUPABASE_PROXY_TABLE_ALLOWLIST=
# Column allowlist: JSON object mapping table names to allowed filter columns
# Example: {"users":["id","email"],"orders":["id","user_id","status"]}
SUPABASE_PROXY_COLUMN_ALLOWLIST=
# Comma-separated list of roles allowed to use the proxy (default: ops,admin)
SUPABASE_PROXY_ALLOWED_ROLES=ops,admin
# Rate limit: max requests per user per minute (default: 100)
SUPABASE_PROXY_RATE_LIMIT=100
# --- Supabase API Proxy Configuration (Netlify Functions) ---
# Table allowlist: JSON mapping of tables to allowed actions
# Example: {"users":["select","update"],"orders":["select","insert","update"]}
SUPABASE_PROXY_TABLE_ALLOWLIST=

# Column allowlist: JSON mapping of tables to allowed filter columns
# Example: {"users":["id","email"],"orders":["id","user_id","status"]}
SUPABASE_PROXY_COLUMN_ALLOWLIST=

# Allowed user roles for proxy access (comma-separated, default: ops,admin)
SUPABASE_PROXY_ALLOWED_ROLES=ops,admin

# Rate limit: requests per minute per user (default: 60)
SUPABASE_PROXY_RATE_LIMIT=60

ADMIN_INVITE_REDIRECT_URL=http://localhost:5173/admin/login

# --- Netlify API Proxy Configuration (apps/client) ---
# Comma-separated list of allowed roles (default: "ops,admin")
SUPABASE_PROXY_ALLOWED_ROLES=ops,admin
# JSON config for allowed tables and operations. Supports two formats:
# Simple: {"table": ["select", "update"]}
# Enhanced: {"table": {"actions": ["select"], "filterableColumns": ["id", "user_id"]}}
# IMPORTANT: filterableColumns must be specified to use filters, otherwise all filters are rejected
SUPABASE_PROXY_TABLE_ALLOWLIST=

AGENTS_BASE_URL=
AGENTS_TENANT_ID=
AGENTS_LOCATION_ID=
SUPABASE_FUNCTIONS_URL=
CANARY_TENANT_ID=
CANARY_AGENT=waiter
CANARY_FLAG=canary
SMOKE_LOCATION_ID=
SMOKE_MENU_ID=
SMOKE_IMAGE_PATH=
OCR_CONVERTER_TOKEN=

# --- Netlify API Proxy Configuration ---
# Allowlist of tables and operations for the API proxy
# Supports both simple and enhanced formats:
# Simple: {"table": ["select", "insert"]}
# Enhanced: {"table": {"actions": ["select"], "allowedColumns": ["id", "name"], "allowedFilterColumns": ["id"], "allowedFilterOperators": ["eq"]}}
# See apps/client/netlify/functions/README.md for full documentation
SUPABASE_PROXY_TABLE_ALLOWLIST={"tenants":{"actions":["select","update"],"allowedColumns":["id","name","status"],"allowedFilterColumns":["id"],"allowedFilterOperators":["eq"]}}
# Comma-separated list of allowed user roles (default: ops,admin)
SUPABASE_PROXY_ALLOWED_ROLES=ops,admin

# --- OpenAI Realtime API (agents-service) ---
OPENAI_REALTIME_ENDPOINT=wss://api.openai.com/v1/realtime
OPENAI_REALTIME_MODEL=gpt-4o-realtime-preview-2024-12-17
DEFAULT_PERSONA=waiter
AI_REALTIME_ENABLED=true

# Leave unset locally to auto-boot Vite. CI secrets point at https://staging.icupa.dev.
PLAYWRIGHT_BASE_URL=http://localhost:5173

# --- MCP (Model Context Protocol) for AI Agents ---
SUPABASE_MCP_REMOTE_URL=
SUPABASE_MCP_LOCAL_URL=http://localhost:54321/mcp
SUPABASE_MCP_OAUTH_CLIENT_ID=
SUPABASE_MCP_OAUTH_CLIENT_SECRET=
SUPABASE_WAITER_AGENT_KEY=
SUPABASE_CFO_AGENT_KEY=
SUPABASE_LEGAL_AGENT_KEY=
SUPABASE_MCP_AUDIT_KEY=

# --- Optional tuning ---
AGENT_TIMEOUT_MS=45000
APP_BASE_URL=http://localhost:5173
OTEL_EXPORTER_OTLP_ENDPOINT=
OTEL_EXPORTER_OTLP_HEADERS=

# --- WhatsApp Cloud API ---
WA_PHONE_NUMBER_ID=
WA_ACCESS_TOKEN=
WA_VERIFY_TOKEN=
WA_API_BASE=https://graph.facebook.com/v19.0

# --- Telephony/SIP (provider-specific) ---
SIP_TRUNK_URI=
SIP_AUTH_USER=
SIP_AUTH_PASS=

# --- Observability ---
OTEL_SERVICE_NAME=ai-agents
LOG_LEVEL=info

# --- Feature Flags ---
AI_RESPONSES_ENABLED=true
WHATSAPP_INTEGRATION_ENABLED=true
VOUCHER_CREATION_ENABLED=true
VOUCHER_REDEMPTION_ENABLED=true
TELEMETRY_ENABLED=false
DEBUG_LOGGING_ENABLED=false
# App Configuration
VITE_APP_NAME=ICUPA
VITE_APP_VERSION=1.0.0
VITE_PUBLIC_URL=https://icupa.netlify.app
VITE_ADMIN_URL=https://icupa-admin.netlify.app

# Features
VITE_ENABLE_PWA=true
VITE_ENABLE_ANALYTICS=false
VITE_ENABLE_OFFLINE=true

# Netlify
NETLIFY_AUTH_TOKEN=your-netlify-auth-token
NETLIFY_CLIENT_SITE_ID=your-client-site-id
NETLIFY_ADMIN_SITE_ID=your-admin-site-id

# Build
NODE_VERSION=18.18.2
PNPM_VERSION=10.0.0
